/*!
 * Document Library Pro 1.6
 * Copyright 2022 Barn2 Plugins
 */
(()=>{"use strict";const a=window.lodash;jQuery((function(t){function i(a,t){const i=a.find(".dlp-grid-documents"),e=a.find("footer .dlp-grid-pagination"),n=a.find("header .dlp-grid-pagination"),r=a.find("footer .dlp-grid-totals"),d=a.find("header .dlp-grid-totals");t.grid&&i.replaceWith(t.grid),t.no_matching_documents&&i.html(t.no_matching_documents),e.length>0&&t.pagination&&e.replaceWith(t.pagination.footer),n.length>0&&t.pagination&&n.replaceWith(t.pagination.header),r.length>0&&t.totals&&r.replaceWith(t.totals.footer),d.length>0&&t.totals&&d.replaceWith(t.totals.header)}new class{constructor(){t(document).on("click",".dlp-grid-paginate-button",this.handleFetchGrid),t(document).on("click",".dlp-grid-card-featured-img",this.openPhotoswipe),t(document).on("input",'.dlp-grid-search input[type="search"]',(0,a.debounce)(this.handleGridSearch,300)),t(document).on("click",".dlp-grid-reset",this.handleGridReset)}handleFetchGrid(a){const e=t(this);if(e.hasClass("disabled")||e.hasClass("current"))return;const n=e.parents(".dlp-grid-container").first(),r=n.attr("id"),d=t(this).data("page-number");n.block({message:null,overlayCSS:{background:"#fff",opacity:.7}}),t.ajax({url:dlp_grid_params.ajax_url,type:"POST",data:{grid_id:r,page_number:d,action:dlp_grid_params.ajax_action,_ajax_nonce:dlp_grid_params.ajax_nonce},xhrFields:{withCredentials:!0}}).done((function(a){t("html, body").animate({scrollTop:n.offset().top-50},300),i(n,a),n.unblock()})),n.addClass("grid-loaded")}handleGridSearch(a){const e=t(this),n=e.parents(".dlp-grid-container").first(),r=n.attr("id");let d=n.find('.dlp-grid-search input[type="search"]').val();n.find('.dlp-grid-search input[type="search"]').not(this).each((function(a){t(this).val(e.val())})),d.length<=3&&(d=""),n.block({message:null,overlayCSS:{background:"#fff",opacity:.7}}),t.ajax({url:dlp_grid_params.ajax_url,type:"POST",data:{grid_id:r,search_query:d,page_number:1,action:dlp_grid_params.ajax_action,_ajax_nonce:dlp_grid_params.ajax_nonce},xhrFields:{withCredentials:!0}}).done((function(a){i(n,a),n.unblock()})),n.addClass("grid-loaded")}handleGridReset(a){a.preventDefault();const e=t(this).parents(".dlp-grid-container").first(),n=e.attr("id");e.find('.dlp-grid-search input[type="search"]').each((function(a){t(this).val("")})),e.block({message:null,overlayCSS:{background:"#fff",opacity:.7}}),t.ajax({url:dlp_grid_params.ajax_url,type:"POST",data:{grid_id:n,search_query:"",page_number:1,action:dlp_grid_params.ajax_action,_ajax_nonce:dlp_grid_params.ajax_nonce},xhrFields:{withCredentials:!0}}).done((function(a){i(e,a),e.unblock()}))}openPhotoswipe(a){a.stopPropagation();const i=t(".pswp")[0],e=t(this).find("img");if(e.length<1)return;const n=[{src:e.attr("data-large_image"),w:e.attr("data-large_image_width"),h:e.attr("data-large_image_height"),title:e.attr("data-caption")&&e.attr("data-caption").length?e.attr("data-caption"):e.attr("title")}];return new PhotoSwipe(i,PhotoSwipeUI_Default,n,{index:0,shareEl:!1,closeOnScroll:!1,history:!1,hideAnimationDuration:0,showAnimationDuration:0}).init(),!1}}}))})();